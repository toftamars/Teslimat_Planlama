<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Ana Menu Action (Yetkiye göre yönlendirme) -->
    <record id="action_teslimat_planlama_root" model="ir.actions.server">
        <field name="name">Teslimat Ana Sayfa</field>
        <field name="model_id" ref="model_teslimat_ana_sayfa"/>
        <field name="state">code</field>
        <field name="code">
# Kullanıcı yetkisine göre yönlendirme
try:
    if env.user.has_group('teslimat_planlama.group_teslimat_driver'):
        # Sürücü ise bugünkü teslimatları göster
        action = env.ref('teslimat_planlama.action_teslimat_belgesi_surucu').read()[0]
    else:
        # Normal kullanıcı ise ana sayfaya yönlendir
        action = env.ref('teslimat_planlama.action_teslimat_ana_sayfa').read()[0]
except:
    # Hata durumunda ana sayfaya yönlendir
    action = env.ref('teslimat_planlama.action_teslimat_ana_sayfa').read()[0]

action['target'] = 'current'
        </field>
    </record>

    <!-- Ana Menu -->
    <menuitem id="menu_teslimat_planlama_root" 
              name="📋 Teslimat" 
              action="action_teslimat_planlama_root"
              sequence="50"/>

    <!-- 📋 Teslimat Ana Menüleri -->
    
    <!-- 🏠 Ana Sayfa (Normal kullanıcılar için) -->
    <menuitem id="menu_teslimat_ana_sayfa" 
              name="🏠 Ana Sayfa" 
              parent="menu_teslimat_planlama_root" 
              action="action_teslimat_ana_sayfa" 
              sequence="5"/>
    
    <!-- 📄 Teslimat Belgeleri (Normal kullanıcılar için) -->
    <menuitem id="menu_teslimat_belgeleri" 
              name="📄 Teslimat Belgeleri" 
              parent="menu_teslimat_planlama_root" 
              sequence="10"/>
    
    <menuitem id="menu_action_teslimat_belgesi" 
              name="📄 Teslimat Belgeleri" 
              parent="menu_teslimat_belgeleri" 
              action="action_teslimat_belgesi" 
              sequence="10"/>

    <!-- 🚚 Bugünkü Teslimatlarım (Sürücüler için) -->
    <menuitem id="menu_teslimat_belgeleri_surucu" 
              name="🚚 Bugünkü Teslimatlarım" 
              parent="menu_teslimat_planlama_root" 
              action="action_teslimat_belgesi_surucu" 
              sequence="5"
              groups="teslimat_planlama.group_teslimat_driver"/>

    <!-- 🔧 Yönetici Menüleri (Sadece Yöneticiler) -->
    <menuitem id="menu_teslimat_yonetici" 
              name="🔧 Yönetici Menüleri" 
              parent="menu_teslimat_planlama_root" 
              sequence="20"
              groups="teslimat_planlama.group_teslimat_manager,stock.group_stock_manager"/>

    <!-- 🚗 Teslimat Araçları -->
    <menuitem id="menu_teslimat_araclar" 
              name="🚗 Teslimat Araçları" 
              parent="menu_teslimat_yonetici" 
              sequence="10"
              groups="teslimat_planlama.group_teslimat_manager,stock.group_stock_manager"/>
    
    <menuitem id="menu_action_teslimat_arac" 
              name="🚗 Teslimat Araçları" 
              parent="menu_teslimat_araclar" 
              action="action_teslimat_arac" 
              sequence="10"
              groups="teslimat_planlama.group_teslimat_manager,stock.group_stock_manager"/>

    <!-- 📅 Teslimat Günleri -->
    <menuitem id="menu_teslimat_gunler" 
              name="📅 Teslimat Günleri" 
              parent="menu_teslimat_yonetici" 
              sequence="20"
              groups="teslimat_planlama.group_teslimat_manager,stock.group_stock_manager"/>
    
    <menuitem id="menu_action_teslimat_gun" 
              name="📅 Teslimat Günleri" 
              parent="menu_teslimat_gunler" 
              action="action_teslimat_gun" 
              sequence="10"
              groups="teslimat_planlama.group_teslimat_manager,stock.group_stock_manager"/>

    <!-- ⚙️ Teslimat Programı Kurulumu -->
    <menuitem id="menu_teslimat_program_kurulum" 
              name="⚙️ Teslimat Programı Kurulumu" 
              parent="menu_teslimat_yonetici" 
              sequence="30"
              groups="teslimat_planlama.group_teslimat_manager,stock.group_stock_manager"/>
    
    <menuitem id="menu_action_teslimat_program_kurulum" 
              name="⚙️ Teslimat Programı Kurulumu" 
              parent="menu_teslimat_program_kurulum" 
              action="action_teslimat_program_kurulum" 
              sequence="10"
              groups="teslimat_planlama.group_teslimat_manager,stock.group_stock_manager"/>

    <!-- 🔧 Konfigürasyon -->
    <menuitem id="menu_teslimat_konfigurasyon" 
              name="🔧 Konfigürasyon" 
              parent="menu_teslimat_yonetici" 
              sequence="40"
              groups="teslimat_planlama.group_teslimat_manager,stock.group_stock_manager"/>
    
    <!-- 🏙️ Şehirler -->
    <menuitem id="menu_teslimat_sehirler" 
              name="🏙️ Şehirler" 
              parent="menu_teslimat_konfigurasyon" 
              sequence="10"
              groups="teslimat_planlama.group_teslimat_manager,stock.group_stock_manager"/>
    
    <menuitem id="menu_action_teslimat_sehir" 
              name="🏙️ Şehirler" 
              parent="menu_teslimat_sehirler" 
              action="action_teslimat_sehir" 
              sequence="10"
              groups="teslimat_planlama.group_teslimat_manager,stock.group_stock_manager"/>
    
    <!-- 🏘️ İlçeler -->
    <menuitem id="menu_teslimat_ilceler" 
              name="🏘️ İlçeler" 
              parent="menu_teslimat_konfigurasyon" 
              sequence="20"
              groups="teslimat_planlama.group_teslimat_manager,stock.group_stock_manager"/>
    
    <menuitem id="menu_action_teslimat_ilce" 
              name="🏘️ İlçeler" 
              parent="menu_teslimat_ilceler" 
              action="action_teslimat_ilce" 
              sequence="10"
              groups="teslimat_planlama.group_teslimat_manager,stock.group_stock_manager"/>

    <!-- 📊 Raporlama ve Analiz -->
    <menuitem id="menu_teslimat_raporlama" 
              name="📊 Raporlama" 
              parent="menu_teslimat_yonetici" 
              sequence="50"
              groups="teslimat_planlama.group_teslimat_manager,stock.group_stock_manager"/>
    
    <menuitem id="menu_action_teslimat_planlama_akilli" 
              name="🧠 Akıllı Planlama" 
              parent="menu_teslimat_raporlama" 
              action="action_teslimat_planlama_akilli" 
              sequence="10"
              groups="teslimat_planlama.group_teslimat_manager,stock.group_stock_manager"/>
    
    <menuitem id="menu_action_teslimat_kapasite_onay" 
              name="✅ Kapasite Onayları" 
              parent="menu_teslimat_raporlama" 
              action="action_teslimat_kapasite_onay" 
              sequence="20"
              groups="teslimat_planlama.group_teslimat_manager,stock.group_stock_manager"/>

    <!-- 🔄 Eski Menüler (Geriye Uyumluluk) -->
    <menuitem id="menu_teslimat_planlama" 
              name="📋 Planlamalar" 
              parent="menu_teslimat_yonetici" 
              sequence="60"
              groups="teslimat_planlama.group_teslimat_manager,stock.group_stock_manager"/>
    
    <menuitem id="menu_action_teslimat_planlama" 
              name="📋 Teslimat Planlamaları" 
              parent="menu_teslimat_planlama" 
              action="action_teslimat_planlama" 
              sequence="10"
              groups="teslimat_planlama.group_teslimat_manager,stock.group_stock_manager"/>
    
    <menuitem id="menu_action_teslimat_transfer" 
              name="🔄 Teslimat Transferler" 
              parent="menu_teslimat_planlama" 
              action="action_teslimat_transfer" 
              sequence="20"
              groups="teslimat_planlama.group_teslimat_manager,stock.group_stock_manager"/>
</odoo>
